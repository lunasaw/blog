(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{340:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_1、环境说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、环境说明"}},[s._v("#")]),s._v(" 1、环境说明")]),s._v(" "),t("p",[s._v("环境就不进行说明了，比较三次配置，一个配过九台，每每情况各有不同。只能告知各位读者，博主这里使用的是red hat红帽，估计centOS也差不太多，不过有差异也无妨，学会博主方法，相信你就不会蒙蔽了，知道怎么往对的方向走了")]),s._v(" "),t("h1",{attrs:{id:"_2、场景说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、场景说明"}},[s._v("#")]),s._v(" 2、场景说明")]),s._v(" "),t("p",[s._v("要求node1免密登录到node2，这里任选了一个用户，也即是")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ssh node2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h1",{attrs:{id:"_3、ssh登录原理过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、ssh登录原理过程"}},[s._v("#")]),s._v(" 3、ssh登录原理过程")]),s._v(" "),t("p",[t("img",{attrs:{src:"/blog/img/ssh/ssh-2.png",alt:"/blog/img/ssh/ssh-2.png"}})]),s._v(" "),t("p",[s._v("这里看不懂也没关系，楼主详解一番：")]),s._v(" "),t("p",[s._v("node1发送一个请求，问：node2，你在不在？我想连接你")]),s._v(" "),t("p",[s._v("node2查找本地是否有node1的公钥，情况一：没有，情况二：有")]),s._v(" "),t("p",[s._v("情况一：")]),s._v(" "),t("p",[s._v("node2回复说：我在！你的公钥告诉我一下。")]),s._v(" "),t("p",[s._v("node1再次发送过去，自己的公钥，")]),s._v(" "),t("p",[s._v("node2在本地进行计算，存储，得到的一串通过公钥得到的不知道什么钥，返回给node1，说：你看看对不对")]),s._v(" "),t("p",[s._v("node1告知node2：对！咱们已经建立连接了")]),s._v(" "),t("p",[s._v("node2警惕的回复node1：你知道我登录密码多少吗？")]),s._v(" "),t("p",[s._v("用户输入密码.....")]),s._v(" "),t("p",[s._v("node1把密码封装了发过去：你看是这个不？")]),s._v(" "),t("p",[s._v("node2回复：对，咱们已经建立连接！")]),s._v(" "),t("p",[s._v("情况二：")]),s._v(" "),t("p",[s._v("node2一看本地有node1的公钥，心想原来认识的，然后通过公钥计算出一个不知道什么钥匙，回复：你看看是这个钥匙吗？")]),s._v(" "),t("p",[s._v("node1告知node2：对！咱们已经建立连接了")]),s._v(" "),t("p",[s._v("node2回复node1：连接建立成功！")]),s._v(" "),t("p",[s._v("具体几次握手，博主不知道，大致就是这么个过程")]),s._v(" "),t("p",[s._v("ssh配置中，会用到下面几个文件：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/blog/img/ssh/ssh-1.png",alt:"/blog/img/ssh/ssh-1.png"}})]),s._v(" "),t("p",[s._v("恩~毫无PS痕迹。。。")]),s._v(" "),t("p",[s._v("1、需要在node1上生成公钥以及私钥，而id_rsa就是私钥，id_rsa.pub文件就是公钥文件。私钥我们这里就不用了，就用公钥，用完了为了保证安全性，你可以选择删掉，也可以不删，根据你的喜好决定，也就是pub文件")]),s._v(" "),t("p",[s._v("2、authorized文件，是为了方便node2的，不用询问node1的公钥本地文件，这个单词读者们需要记住，要建立这个文件！")]),s._v(" "),t("p",[s._v("3、known_hosts，表名node2是认识的主机，这个不用配置，读者可以不用管，可以作为了解原理。比如，一台新系统，.ssh目录下你会发现没有这个文件，但在你第一次ssh以后，这个文件就会生成。")]),s._v(" "),t("p",[s._v("简单说明：")]),s._v(" "),t("p",[s._v("​       上面做了原理说明，简单来说：就是node1想要连接node2免密登录node2，需要把node1的id_rsa.pub文件内容写进node2的authorized_keys里面。就大功告成了")]),s._v(" "),t("h1",{attrs:{id:"_4、最简单配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、最简单配置"}},[s._v("#")]),s._v(" 4、最简单配置")]),s._v(" "),t("h2",{attrs:{id:"_4-1、生成公钥以及密钥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、生成公钥以及密钥"}},[s._v("#")]),s._v(" 4.1、生成公钥以及密钥：")]),s._v(" "),t("p",[s._v("在node1上：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("keygen "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t rsa\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("一路回车。")]),s._v(" "),t("p",[s._v('若是不想回车，可在上面代码末尾加上，-P ""')]),s._v(" "),t("h2",{attrs:{id:"_4-2、处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、处理"}},[s._v("#")]),s._v(" 4.2、处理")]),s._v(" "),t("p",[s._v("方法一：")]),s._v(" "),t("h2",{attrs:{id:"将node1的公钥拷贝到node2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将node1的公钥拷贝到node2"}},[s._v("#")]),s._v(" 将node1的公钥拷贝到node2")]),s._v(" "),t("p",[s._v("node1上(小心别把node2的id_rsa.pub覆盖掉)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ scp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"然后-node2将公钥加入自身认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#然后-node2将公钥加入自身认证"}},[s._v("#")]),s._v(" 然后，node2将公钥加入自身认证")]),s._v(" "),t("p",[s._v("在node2上：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ cat id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" authorized_key\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("验证查看文件authorized_key中是否有id_rsa.pub1文件的内容")]),s._v(" "),t("p",[s._v("方法二：")]),s._v(" "),t("h2",{attrs:{id:"直接把自己密钥拷贝到需要免密的机器上"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接把自己密钥拷贝到需要免密的机器上"}},[s._v("#")]),s._v(" 直接把自己密钥拷贝到需要免密的机器上：")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[s._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("copy"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub 用户名@ip\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("将密钥文件直接拷贝到指定用户名、ip。输入密码后，下次你当前用户执行ssh到刚刚指定的用户名ip就不用再输入密码了。")]),s._v(" "),t("p",[s._v("方法二较方法一方便很多")]),s._v(" "),t("h2",{attrs:{id:"_4-4、验证-node1连接node2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、验证-node1连接node2"}},[s._v("#")]),s._v(" 4.4、验证：node1连接node2")]),s._v(" "),t("p",[s._v("在node1上：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ssh hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@node2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("楼主这里没有截图，不用输入密码发现主机名变了即为成功")]),s._v(" "),t("h1",{attrs:{id:"_5、调试及常规报错解决"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、调试及常规报错解决"}},[s._v("#")]),s._v(" 5、调试及常规报错解决")]),s._v(" "),t("h2",{attrs:{id:"_5-1、说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1、说明"}},[s._v("#")]),s._v(" 5.1、说明")]),s._v(" "),t("p",[s._v("系统日志：/var/log/secure，是个不知道干什么用的日志。ssh连接失败的报错，在这里记录")]),s._v(" "),t("h2",{attrs:{id:"_5-2、报错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2、报错"}},[s._v("#")]),s._v(" 5.2、报错")]),s._v(" "),t("p",[t("img",{attrs:{src:"/blog/img/ssh/ssh-3.png",alt:"/blog/img/ssh/ssh-3.png"}})]),s._v(" "),t("p",[s._v("解决：相关目录权限不对，一下列出相关权限。读者根据具体去修改")]),s._v(" "),t("p",[s._v("​    1、755         ~")]),s._v(" "),t("p",[s._v("​    2、700         ~/.ssh")]),s._v(" "),t("p",[s._v("​    3、644         ~/.ssh/authorized_keys(博主实测，600也可，具体的读者试试也就知道了，也不麻烦)")]),s._v(" "),t("p",[s._v("配置文件选项未开（无图）")]),s._v(" "),t("p",[s._v("这里楼主没有碰到过，所以没有图，各位读者碰到修改了就好")]),s._v(" "),t("p",[s._v("解决： vi   /etc/ssh/sshd_config")]),s._v(" "),t("p",[t("img",{attrs:{src:"/blog/img/ssh/ssh-4.png",alt:"/blog/img/ssh/ssh-4.png"}})]),s._v(" "),t("p",[s._v("这三项需要注释掉，按博主图片中这样就好。")])])}),[],!1,null,null,null);a.default=e.exports}}]);